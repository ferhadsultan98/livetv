<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    
    <title>Azərbaycan TV - Pro Player (Fixed)</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.0/dist/hls.min.js"></script>
    <style>
        :root {
            --primary-color: #e50914;
            --bg-color: #141414;
            --sidebar-bg: #1f1f1f;
            --text-color: #ffffff;
            --active-bg: #333;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            border-right: 1px solid #333;
        }

        .header {
            padding: 20px;
            background-color: #000;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 1px;
        }

        .channel-list {
            flex: 1;
            overflow-y: auto;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .channel-item {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid #333;
            transition: 0.2s;
            display: flex;
            align-items: center;
        }

        .channel-item:hover {
            background-color: var(--active-bg);
            border-left: 4px solid var(--primary-color);
        }

        .channel-item.active {
            background-color: #2a2a2a;
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
            font-weight: bold;
        }

        .main-content {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            position: relative;
        }

        video {
            width: 100%;
            height: 100%;
            outline: none;
        }

        .error-msg {
            position: absolute;
            color: white;
            background: rgba(255, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 10;
        }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { height: 40%; width: 100%; order: 2; }
            .main-content { height: 60%; order: 1; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="header">AZ TV PLAYER</div>
        <ul class="channel-list" id="channelList"></ul>
    </div>

    <div class="main-content">
        <div class="error-msg" id="errorMsg"></div>
        <video id="video" controls autoplay playsinline></video>
    </div>

    <script>
        // YALNIZ HTTPS DƏSTƏKLƏYƏN VƏ YA STABİL KANALLAR
        // Qeyd: AzTV HTTPS dəstəkləmədiyi üçün bəzən açılmaya bilər.
        const channels = [
            { name: "İctimai TV (HD)", url: "https://live.itv.az/itv.m3u8" },
            { name: "ARB TV", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/main/myvideo-az/arb.m3u8" },
            { name: "ARB 24", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/main/myvideo-az/arb-24.m3u8" },
            { name: "Xəzər TV", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/main/myvideo-az/xezer-tv.m3u8" },
            { name: "Space TV", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/main/myvideo-az/space-tv.m3u8" },
            { name: "Baku TV", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/refs/heads/main/myvideo-az/baku-tv.m3u8" },
            { name: "Mədəniyyət TV", url: "https://str.yodacdn.net/medeniyyet/index.m3u8" },
            { name: "CBC Sport", url: "https://mn-nl.mncdn.com/cbcsports_live/cbcsports/playlist.m3u8" },
            { name: "Real TV", url: "https://tv.realtv.az/hls/stream.m3u8" }, 
            { name: "MTV Azərbaycan", url: "https://raw.githubusercontent.com/UzunMuhalefet/streams/refs/heads/main/myvideo-az/mtv-azerbaycan.m3u8" }
        ];

        const video = document.getElementById('video');
        const listContainer = document.getElementById('channelList');
        const errorMsg = document.getElementById('errorMsg');
        let hls = null;

        function renderChannels() {
            channels.forEach(channel => {
                let li = document.createElement('li');
                li.className = 'channel-item';
                li.innerText = channel.name;
                li.onclick = () => playChannel(channel.url, li);
                listContainer.appendChild(li);
            });
        }

        function playChannel(url, element) {
            document.querySelectorAll('.channel-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            errorMsg.style.display = 'none';

            if (Hls.isSupported()) {
                if (hls) hls.destroy();
                hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
                
                // Xəta tutmaq üçün
                hls.on(Hls.Events.ERROR, function (event, data) {
                    if (data.fatal) {
                        console.log("Xəta baş verdi:", data);
                        errorMsg.innerText = "Kanal açılmadı (Mənbə xətası və ya HTTPS blok)";
                        errorMsg.style.display = 'block';
                    }
                });
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = url;
                video.addEventListener('loadedmetadata', () => video.play());
            }
        }

        renderChannels();
    </script>
</body>
</html>
